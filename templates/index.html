<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Maestro JSON Certificate Dashboard — v1.5</title>
  <link rel="stylesheet" href="/static/css/app.css" />
</head>
<body>
  <header class="topbar">
    <h1>Maestro Certificate Rotation (JSON)</h1>
    <div class="actions">
      <button class="btn" id="btnCSV">Export CSV</button>
      <button class="btn" id="btnJSON">Export JSON</button>
    </div>
  </header>

  <section class="card" style="margin-top:8px;">
    <div class="controls">
      <label>SLA
        <select id="slaFilter">
          <option value="all">All</option>
          <option value="<=30">&#8804;30</option>
          <option value="<=60">&#8804;60</option>
          <option value="<=90">&#8804;90</option>
        </select>
      </label>
      <span class="muted">Theme: Dark • v1.5</span>
    </div>
  </section>

  <section class="uploader card">
    <div id="dropZone" class="drop-zone">
      <strong>Drop JSON files here</strong>
      <span class="muted">or click to select</span>
      <input id="fileInput" type="file" accept=".json,application/json" multiple hidden>
    </div>
    <span id="status" class="muted"></span>
  </section>

  <section class="card">
    <nav class="tabs">
      <button class="tab active" data-tab="table">Table</button>
      <button class="tab" data-tab="timeline">Timeline</button>
      <button class="tab" data-tab="chains">Chains</button>
      <button class="tab" data-tab="insights">Insights</button>
      <button class="tab" data-tab="deploy">Deployments</button>
      <button class="tab" data-tab="found">Foundations</button>
      <button class="tab" data-tab="settings">Settings</button>
    </nav>

    <div id="panel-table" class="tab-panel active">
      <div class="table-wrap">
        <table id="tbl">
          <thead>
            <tr>
              <th>Name</th><th>CA</th><th>Issuer</th><th>Location</th>
              <th>Product</th><th>Valid Until</th><th>Days</th><th>SLA</th><th>Depth</th><th>Root</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div id="panel-timeline" class="tab-panel">
      <div id="timeline" class="list"></div>
    </div>

    <div id="panel-chains" class="tab-panel">
      <div id="chains" class="grid"></div>
    </div>

    <div id="panel-insights" class="tab-panel">
      <div class="controls">
        <label>View
          <select id="heatView">
            <option value="monthly">Monthly panels</option>
            <option value="calendar">Calendar strip</option>
          </select>
        </label>
      </div>
      <div id="insights" class="grid"></div>
    </div>

    <div id="panel-deploy" class="tab-panel">
      <div class="controls">
        <label>deployment_name
          <input id="depQuery" list="depList" placeholder="e.g., diego-cell, router, uaa" style="min-width:260px;">
        <datalist id="depList"></datalist>
        </label>
        <label class="chk"><input type="checkbox" id="depExact">Exact match</label>
      </div>
      <div id="deployChains" class="grid"></div>
      <div id="deployHelp" class="card" style="display:none;"></div>
    </div>

    <div id="panel-found" class="tab-panel">
      <div class="card" style="margin:0;">
        <h3>Foundation Mapping</h3>
        <p class="muted">Exact-match mapping for deployment names that start with <code>p-bosh-</code>. Changes persist in your browser (LocalStorage). Export to share with teammates.</p>
        <div class="controls" style="margin:8px 0;">
          <button class="btn" id="mapSuggest">Auto-suggest from current data</button>
          <button class="btn" id="mapAdd">Add Row</button>
          <button class="btn" id="mapApply">Apply</button>
          <button class="btn" id="mapExport">Export</button>
          <input type="file" id="mapImportFile" accept="application/json" hidden>
          <button class="btn" id="mapImport">Import</button>
        </div>
        <div class="table-wrap" style="max-height:40vh;">
          <table id="mapTbl">
            <thead><tr><th style="width:55%;">Raw foundation id (p-bosh-...)</th><th>Friendly name</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="muted" id="mapStats" style="margin-top:8px;"></div>
      </div>
    </div>

    <div id="panel-settings" class="tab-panel">
      <div class="card" style="margin:0;">
        <h3>Display Settings</h3>
        <div class="controls" style="margin:8px 0;">
          <label>Card height
            <input type="number" id="cardHeightPx" min="200" max="2000" step="20" value="800" style="width:100px;"> px
          </label>
          <button class="btn" id="cardApply">Apply</button>
          <span class="muted">Persists to this browser via localStorage.</span>
        </div>
      </div>
    </div>

  </section>

  <script src="/static/js/app.js"></script>
</body>
</html>
